@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<CollectionsOnline.WebSite.Features.Search.SearchViewModel>
@{
    Layout = "layout.cshtml";
}
<div id="search">
    <aside class="facets">
        <a href="#" class="button-filter">
            <span class="icon-filter" aria-hidden="true"></span>
            Filter by
        </a>
        @foreach (var facet in Model.Facets)
        {
            <h4>@facet.Name</h4>
            foreach (var value in facet.Values)
            {
                if (value.Active)
                {
                    <a href="@value.Url" class="active">@value.Name <span class="badge">(@value.Hits)</span></a>
                }
                else
                {
                    <a href="@value.Url">@value.Name <span class="badge">(@value.Hits)</span></a>
                }

            }
        }
    </aside>
    <div class="results">
        @Html.Partial("searchbar", Model)
        @if (Model.ActiveFacets.Any() || Model.ActiveTerms.Any())
        {
            <div class="active-facets">
                @foreach (var activeFacet in Model.ActiveFacets)
                {
                    <a href="@activeFacet.Url">
                        @activeFacet.Name
                        <span class="icon-close" aria-hidden="true"></span>
                        <span class="icon-label-hidden">Remove facet</span>
                    </a>
                }
                @foreach (var activeTerm in Model.ActiveTerms)
                {
                    <a href="@activeTerm.Url">
                        @activeTerm.Name
                        <span class="icon-close" aria-hidden="true"></span>
                        <span class="icon-label-hidden">Remove facet</span>
                    </a>
                }
            </div>
        }
        <div class="pagination">
            <div class="counts"><strong>@Model.TotalResults</strong> results, displaying <strong>@(Model.Offset+1)</strong> to <strong>@(Model.Limit + Model.Offset)</strong></div>
            <a href="@Model.PrevPageUrl" class="button @(string.IsNullOrWhiteSpace(@Model.PrevPageUrl) ? "disabled" : "")"><span class="icon-left-arrow"></span> Previous</a>
            <a href="@Model.NextPageUrl" class="button @(string.IsNullOrWhiteSpace(@Model.NextPageUrl) ? "disabled" : "")">Next <span class="icon-right-arrow"></span></a>
        </div>
        <div class="results-area">
            @foreach (var result in Model.Results)
            {
                <div class="@result.Type.ToLower()">
                    <a href="/@result.Id">
                        @if (string.IsNullOrWhiteSpace(result.ThumbnailUri))
                        {
                            <span class="no-image">
                                <span class="no-image-label">No Image</span>
                            </span>
                        }
                        else
                        {
                            <img src="@result.ThumbnailUri" />
                        }
                        <span class="title">@Html.Raw(result.Name)</span>
                    </a>
                </div>
            }
        </div>
        <div class="pagination bottom">
            <div class="counts"><strong>@Model.TotalResults</strong> results, displaying <strong>@(Model.Offset+1)</strong> to <strong>@(Model.Limit + Model.Offset)</strong></div>
            <a href="@Model.PrevPageUrl" class="button @(string.IsNullOrWhiteSpace(@Model.PrevPageUrl) ? "disabled" : "")"><span class="icon-left-arrow"></span> Previous</a>
            <a href="@Model.NextPageUrl" class="button @(string.IsNullOrWhiteSpace(@Model.NextPageUrl) ? "disabled" : "")">Next <span class="icon-right-arrow"></span></a>
        </div>
    </div>
</div>









@*<div class="container">
    <div class="row">
        <div class="col-md-3">

        </div>
        <div class="col-md-9">
            <div class="btn-toolbar search-active-facets" role="toolbar">
                @foreach (var activeFacet in Model.ActiveFacets)
                {
                    <a class="btn btn-info" href="@activeFacet.Url">
                        <strong>@activeFacet.Name</strong><span class="glyphicon glyphicon-remove"></span>
                    </a>
                }
                @foreach (var activeTerm in Model.ActiveTerms)
                {
                    <a class="btn btn-warning" href="@activeTerm.Url">
                        <strong>@activeTerm.Name</strong><span class="glyphicon glyphicon-remove"></span>
                    </a>
                }
            </div>               
            <nav class="navbar navbar-default" role="navigation">
                <p class="navbar-text navbar-left">
                    <strong>@Model.TotalResults Results (Query @(Model.QueryTimeElapsed)ms, Facets[@Model.TotalFacetValues] @(Model.FacetTimeElapsed)ms)</strong>
                </p>
                <div class="nav navbar-right search-results-pagination">
                    <span class="navbar-text navbar-left">Page @Model.CurrentPage of @Model.TotalPages </span>
                    <a role="button" href="@Model.PrevPageUrl" class="btn btn-xs navbar-btn btn-default @(string.IsNullOrWhiteSpace(@Model.PrevPageUrl) ? "disabled" : "")"><span class="glyphicon glyphicon-chevron-left"></span> Previous</a>
                    <a role="button" href="@Model.NextPageUrl" class="btn btn-xs navbar-btn btn-default @(string.IsNullOrWhiteSpace(@Model.NextPageUrl) ? "disabled" : "")">Next <span class="glyphicon glyphicon-chevron-right"></span></a>
                </div>
            </nav>
            @if (Model.Suggestions.Count > 0)
            {
                <div>
                    Did you mean?

                    @foreach (var suggestion in Model.Suggestions)
                    {
                        <a href="@suggestion.Url">@suggestion.Suggestion</a>
                    }
                </div>
            }
            <div class="list-group search-results">
                @foreach (var result in Model.Results)
                {
                    <div class="list-group-item @result.Type.ToLower()">
                        <div class="row">
                            <div class="col-md-2">
                                <a href="@result.Id">
                                    <img src="@(string.IsNullOrWhiteSpace(result.ThumbnailUri) ? "http://placehold.it/110" : result.ThumbnailUri)" width="110" height="110" class="img-thumbnail" />
                                </a>
                            </div>
                            <div class="col-md-10">
                                <h4><a href="@result.Id">@result.Name</a></h4>
                                <div class="summary">
                                    @result.Summary
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <nav class="navbar navbar-default" role="navigation">
                <p class="navbar-text navbar-left"><strong>@Model.TotalResults Results</strong></p>
                <div class="nav navbar-right search-results-pagination">
                    <span class="navbar-text navbar-left">Page @Model.CurrentPage of @Model.TotalPages </span>
                    <a role="button" href="@Model.PrevPageUrl" class="btn btn-xs navbar-btn btn-default @(string.IsNullOrWhiteSpace(@Model.PrevPageUrl) ? "disabled" : "")"><span class="glyphicon glyphicon-chevron-left"></span> Previous</a>
                    <a role="button" href="@Model.NextPageUrl" class="btn btn-xs navbar-btn btn-default @(string.IsNullOrWhiteSpace(@Model.NextPageUrl) ? "disabled" : "")"><span class="glyphicon glyphicon-chevron-right"></span> Next</a>
                </div>
            </nav>
        </div>
    </div>
</div>*@